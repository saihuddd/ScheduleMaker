*** convertExcel2txt.py	2025-10-04 00:00:00.000000000 +0800
--- convertExcel2txt.py	2025-10-04 00:00:00.000000000 +0800
***************
*** 237,252 ****
-                date_str = QDate(year, month, day).toString("yyyy-MM-dd")
-                text = f"{day}\n{schedule_dict.get(date_str, '')}"
-
-                item = QTableWidgetItem(text)
-                item.setTextAlignment(Qt.AlignTop | Qt.AlignLeft)
-                item.setToolTip(text)
-
-                for k, c in color_map.items():
-                    if k in text:
-                        item.setBackground(c)
-                        break
-
-                self.table.setItem(row, col, item)
-                day += 1
--- 237,265 ----
+                import datetime
+                import chinese_calendar as cc
+
+                date_obj = datetime.date(year, month, day)
+                # 获取节日名称
+                holiday_detail = cc.get_holiday_detail(date_obj)
+                if holiday_detail:
+                    first_line = f"{day} {holiday_detail.name}"
+                else:
+                    first_line = f"{day}"
+
+                schedule_text = schedule_dict.get(date_obj.strftime("%Y-%m-%d"), '')
+
+                # 构造带富文本的内容，节日红色
+                if holiday_detail:
+                    text = f'<span>{first_line.split(" ")[0]} </span><span style="color:red">{first_line.split(" ")[1]}</span><br>{schedule_text}'
+                else:
+                    text = f"{first_line}<br>{schedule_text}"
+
+                item = QTableWidgetItem()
+                item.setTextAlignment(Qt.AlignTop | Qt.AlignLeft)
+                item.setToolTip(schedule_text)
+                item.setData(Qt.DisplayRole, text)
+                item.setFlags(Qt.ItemIsEnabled | Qt.ItemIsSelectable)
+                # 让 QTableWidget 支持 HTML 渲染
+                item.setData(Qt.EditRole, text)
+
+                # 背景色
+                for k, c in color_map.items():
+                    if k in schedule_text:
+                        item.setBackground(c)
+                        break
+
+                self.table.setItem(row, col, item)
+                day += 1
*** End of File
